# セキュリティポリシー

## サポートされているバージョン

現在、以下のバージョンがセキュリティアップデートの対象です：

| バージョン | サポート状況 |
| --------- | ----------- |
| latest    | ✅          |

## 脆弱性の報告

このプロジェクトでセキュリティ上の問題を発見した場合は、公開 Issue ではなく、以下の方法で報告してください：

1. **GitHub Security Advisories** を使用する（推奨）
   - リポジトリの Security タブから「Report a vulnerability」を選択
2. または、プロジェクトオーナーに直接連絡する

以下の情報を含めてください：
- 脆弱性の種類（例: SQL インジェクション、XSS 等）
- 再現手順
- 影響範囲
- 可能であれば修正案

## セキュリティのベストプラクティス

### 本番環境へのデプロイ前に必須の設定

1. **認証情報の設定**
   - `BASIC_AUTH_USER` / `BASIC_AUTH_PASSWORD` を強力なパスワードに設定
   - `API_KEY` をランダムな文字列（64文字以上推奨）に設定

2. **環境変数の確認**
   - `.env` ファイルは絶対に公開リポジトリにコミットしない
   - `app.yaml` は `.gitignore` に含まれていることを確認

3. **HTTPS の有効化**
   - App Engine は自動的に HTTPS を有効化します
   - カスタムドメインを使用する場合は SSL 証明書を設定

4. **データベースアクセス**
   - Cloud SQL は VPC または認証プロキシ経由のみでアクセス
   - パブリック IP を有効にしない

5. **API アクセス制御**
   - 本番環境では信頼できるドメインのみ許可
   - API_KEY は定期的にローテーションする

### 開発環境のセキュリティ

- ローカル開発では `.env` に本番の認証情報を含めない
- Docker コンテナのポートは localhost のみに公開（`127.0.0.1:5433:5432`）
- シードデータに本番データを含めない

## 依存パッケージの脆弱性

定期的に以下のコマンドで依存パッケージの脆弱性をチェックしてください：

```bash
npm audit
npm audit fix
```

## 既知の制限事項

1. **Basic 認証の制限**
   - 暫定的な認証方式です
   - 本番環境では Firebase Auth 等への移行を推奨

2. **API Key 認証**
   - Bearer トークンは単一キーです
   - ユーザーごとの API Key 管理は未実装

3. **CSRF 保護**
   - Server Actions は Next.js の内蔵 CSRF トークンで保護済み
   - REST API は CORS + Bearer トークンで保護

## ポートフォリオとして使用する場合

このプロジェクトはデモ用途として認証を無効化して公開することができます：

- `.env` に `BASIC_AUTH_USER` / `BASIC_AUTH_PASSWORD` / `API_KEY` を設定しない
- すべてのユーザーが認証なしでアクセス可能になります
- **警告**: 実データを含む環境では絶対に認証を無効化しないでください
